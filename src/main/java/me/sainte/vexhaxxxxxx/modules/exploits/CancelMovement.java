package me.sainte.vexhaxxxxxx.modules.exploits;

import me.sainte.vexhaxxxxxx.events.EventSendPacket;
import me.sainte.vexhaxxxxxx.modules.Mod;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;

import java.util.ArrayList;
import java.util.List;

public class CancelMovement extends Mod{
    public List<PlayerMoveC2SPacket> queue = new ArrayList<>();
    public CancelMovement() {
        super("CancelMove", "Robotic Movement brrrrr", Category.EXPLOITS);
    }
    public void onEnable() {
        sendPackets();
        super.onEnable();
    }
    @Override
    public void onDisable() {
        super.onDisable();
    }
    public void sendPacket(EventSendPacket event) {
        if (!(event.getPacket() instanceof PlayerMoveC2SPacket || event.getPacket() instanceof PlayerMoveC2SPacket.PositionAndOnGround)) return;
        queue.add((PlayerMoveC2SPacket) event.getPacket());
        event.setCancelled(true);
    }
    @Override
    public void onTick(){
        super.onTick();
    }
    public void sendPackets() {
        for (PlayerMoveC2SPacket p: new ArrayList<>(queue)){
            mc.player.networkHandler.sendPacket(p);
        }
        queue.clear();
    }
}
